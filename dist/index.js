(()=>{"use strict";var e,t,r={},n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,a),o.exports}a.m=r,a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,r)=>(a.f[r](e,t),t)),[])),a.u=e=>e+".index.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="rsraytracingv2:",a.l=(r,n,o,i)=>{if(e[r])e[r].push(n);else{var s,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var p=l[u];if(p.getAttribute("src")==r||p.getAttribute("data-webpack")==t+o){s=p;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",t+o),s.src=r),e[r]=[n];var m=(t,n)=>{s.onerror=s.onload=null,clearTimeout(d);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((e=>e(n))),t)return t(n)},d=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),c&&document.head.appendChild(s)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{a.b=document.baseURI||self.location.href;var e={179:0};a.f.j=(t,r)=>{var n=a.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,a)=>n=e[t]=[r,a]));r.push(n[2]=o);var i=a.p+a.u(t),s=new Error;a.l(i,(r=>{if(a.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[i,s,c]=r,l=0;if(i.some((t=>0!==e[t]))){for(n in s)a.o(s,n)&&(a.m[n]=s[n]);c&&c(a)}for(t&&t(r);l<i.length;l++)o=i[l],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkrsraytracingv2=self.webpackChunkrsraytracingv2||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();const o=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),s=Symbol("Comlink.releaseProxy"),c=Symbol("Comlink.thrown"),l=e=>"object"==typeof e&&null!==e||"function"==typeof e,u=new Map([["proxy",{canHandle:e=>l(e)&&e[o],serialize(e){const{port1:t,port2:r}=new MessageChannel;return p(e,t),[r,[r]]},deserialize:e=>(e.start(),d(e))}],["throw",{canHandle:e=>l(e)&&c in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function p(e,t=self){t.addEventListener("message",(function r(n){if(!n||!n.data)return;const{id:a,type:i,path:s}=Object.assign({path:[]},n.data),l=(n.data.argumentList||[]).map(v);let u;try{const t=s.slice(0,-1).reduce(((e,t)=>e[t]),e),r=s.reduce(((e,t)=>e[t]),e);switch(i){case"GET":u=r;break;case"SET":t[s.slice(-1)[0]]=v(n.data.value),u=!0;break;case"APPLY":u=r.apply(t,l);break;case"CONSTRUCT":u=function(e){return Object.assign(e,{[o]:!0})}(new r(...l));break;case"ENDPOINT":{const{port1:t,port2:r}=new MessageChannel;p(e,r),u=function(e,t){return y.set(e,t),e}(t,[t])}break;case"RELEASE":u=void 0;break;default:return}}catch(e){u={value:e,[c]:0}}Promise.resolve(u).catch((e=>({value:e,[c]:0}))).then((e=>{const[n,o]=b(e);t.postMessage(Object.assign(Object.assign({},n),{id:a}),o),"RELEASE"===i&&(t.removeEventListener("message",r),m(t))}))})),t.start&&t.start()}function m(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function d(e,t){return h(e,[],t)}function g(e){if(e)throw new Error("Proxy has been released and is not useable")}function h(e,t=[],r=function(){}){let n=!1;const a=new Proxy(r,{get(r,o){if(g(n),o===s)return()=>w(e,{type:"RELEASE",path:t.map((e=>e.toString()))}).then((()=>{m(e),n=!0}));if("then"===o){if(0===t.length)return{then:()=>a};const r=w(e,{type:"GET",path:t.map((e=>e.toString()))}).then(v);return r.then.bind(r)}return h(e,[...t,o])},set(r,a,o){g(n);const[i,s]=b(o);return w(e,{type:"SET",path:[...t,a].map((e=>e.toString())),value:i},s).then(v)},apply(r,a,o){g(n);const s=t[t.length-1];if(s===i)return w(e,{type:"ENDPOINT"}).then(v);if("bind"===s)return h(e,t.slice(0,-1));const[c,l]=f(o);return w(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:c},l).then(v)},construct(r,a){g(n);const[o,i]=f(a);return w(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},i).then(v)}});return a}function f(e){const t=e.map(b);return[t.map((e=>e[0])),(r=t.map((e=>e[1])),Array.prototype.concat.apply([],r))];var r}const y=new WeakMap;function b(e){for(const[t,r]of u)if(r.canHandle(e)){const[n,a]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},a]}return[{type:"RAW",value:e},y.get(e)||[]]}function v(e){switch(e.type){case"HANDLER":return u.get(e.name).deserialize(e.value);case"RAW":return e.value}}function w(e,t,r){return new Promise((n=>{const a=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(r){r.data&&r.data.id&&r.data.id===a&&(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),r)}))}(async()=>{console.log("Loading main thread wasm");const e=await Promise.all([a.e(789),a.e(443)]).then(a.bind(a,789)),t=(await e.default()).memory;console.log("Creating worker");const r=new Worker(new URL(a.p+a.u(288),a.b),{type:void 0});console.log("Wrapping worker in comlink");const n=d(r);console.log("Running worker"),await n.init(t),await n.initThreadPool(),window.rayTracerOptions=JSON.stringify({camera:{x:5,y:5,z:5},rotation:{x:.7,y:-Math.PI/4,z:0},fov:70,width:400,height:300,scene:{objects:[{name:"sphere",material:{colour:[1,.5212054252624512,0],specular:5,metallic:1},geometry:{Sphere:{center:{x:1.5,y:0,z:0},radius:1}}},{name:"sphere",material:{colour:[1,.3486607074737549,0],specular:800,metallic:.2},geometry:{Sphere:{center:{x:3.1,y:0,z:2.1},radius:1}}},{name:"sphere",material:{colour:[0,.6445307731628418,1],specular:80,metallic:0},geometry:{Sphere:{center:{x:-8.3,y:0,z:0},radius:1}}},{name:"plane",material:{colour:[.8000000715255737,.800000011920929,1],specular:50,metallic:.2},geometry:{Plane:{center:{x:0,y:-1.5,z:0},normal:{x:0,y:1,z:0},size:5}}}],lights:[{Direction:{intensity:[.4,.4,.4],direction:{x:-.5345224838248488,y:-.8017837257372732,z:-.2672612419124244}}},{Point:{intensity:[.4,.4,.4],position:{x:0,y:2,z:0}}}],background_colour:[.5,.8,1],ambient_light:[.2,.2,.2],reflection_limit:4,do_objects_spin:!1}}),await n.renderImage(),console.log("Starting egui"),e.start("the_canvas_id"),document.getElementById("center_text").remove()})()})();